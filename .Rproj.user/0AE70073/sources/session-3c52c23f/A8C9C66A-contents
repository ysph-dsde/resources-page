<!--
 * This sidebar component provides category filtering functionality for items
 * displayed on the webpage. It dynamically generates checkboxes based on 
 * available categories from the items data.
 * 
 * Functionality includes:
 *    1. Extracting unique categories from all items in the dataset.
 *    2. Dynamically generating checkbox inputs for each category.
 *    3. Providing a collapsible sidebar interface with hidden class.
 *    4. Form submission handling for category-based filtering.
 *
 * Author: Shelby Golden, M.S.
 *   Date: May 2025
 * 
 * Note: Written with the assistance of Yale's AI, Clarity.
-->

<!-- Sidebar wrapper container with initial hidden state for toggle functionality -->
<aside class="sidebar-wrapper hidden">
  <!-- Inner sidebar container for styling and content organization -->
  <div class="sidebar">
    <!-- Sidebar header title -->
    <h2>Filter Categories</h2>
    
    <!-- Form element for category filtering with unique ID for JavaScript targeting -->
    <form id="categoryFilter" class="form">
      <!-- EJS conditional: Check if items data exists and contains at least one item with categories -->
      <% if (typeof items !== 'undefined' && items[0].items && items[0].items.length > 0) { %>
        
        <!-- Create a Set to store unique categories (prevents duplicates) -->
        <% const categories = new Set(); %>
        
        <!-- Loop through all items in the first items array -->
        <% items[0].items.forEach(function(item) { %>
          <!-- For each item, loop through its categories and add to the Set -->
          <% item.categories.forEach(cat => categories.add(cat)); %>
        <% }); %>
        
        <!-- Convert Set back to array and loop through each unique category -->
        <% [...categories].forEach(function(category) { %>
          <!-- Create a checkbox container div for each category -->
          <div>
            <!-- Generate checkbox input with category value -->
            <input type="checkbox" name="category" value="<%= category %>">
            <!-- Create label displaying the category name -->
            <label><%= category %></label>
          </div>
        <% }); %>
        
      <!-- End of conditional check for items data -->
      <% } %>
    </form>
  </div>
</aside>